<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Image to PDF Converter</title>
<style>
    #container {
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 20px;
    }

    #upload-box {
        border: 2px dashed #aaa;
        padding: 20px;
        text-align: center;
        width: 45%;
    }

    #pdf-box {
        border: 2px dashed #aaa;
        padding: 20px;
        text-align: center;
        width: 45%;
    }

    .image-preview {
        margin-bottom: 10px;
        max-width: 100px;
        max-height: 100px;
    }
</style>
</head>
<body>
<div id="container">
    <div id="upload-box">
        <h2>Upload Images</h2>
        <input type="file" id="file-input" multiple accept="image/*">
        <div id="image-preview-container"></div>
    </div>
    <div id="pdf-box">
        <h2>Convert to PDF</h2>
        <button onclick="convertToPdf()">Convert to PDF</button>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
<script>
    function handleFileSelect(event) {
        const files = event.target.files;
        const previewContainer = document.getElementById('image-preview-container');
        previewContainer.innerHTML = '';

        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            const reader = new FileReader();

            reader.onload = function (e) {
                const img = new Image();
                img.src = e.target.result;
                img.classList.add('image-preview');
                previewContainer.appendChild(img);

                // Rotate the image
                const rotatedImg = new Image();
                rotatedImg.src = e.target.result;
                rotatedImg.classList.add('image-preview');
                rotatedImg.style.transform = 'rotate(180deg)';
                previewContainer.appendChild(rotatedImg);
            };

            reader.readAsDataURL(file);
        }
        imagesUploaded = true;
    }

    document.getElementById('file-input').addEventListener('change', handleFileSelect);

    function convertToPdf() {
        if (!imagesUploaded) {
            alert('Please upload images first.');
            return;
        }
    const images = document.querySelectorAll('.image-preview');

    const pdf = new jsPDF();
    let x = 10;
    let y = 10;
    let count = 0;
    let aspectRatio = 1;

    images.forEach((image, index) => {
        if (index > 0 && index % 16 === 0) {
            pdf.addPage();
            x = 20;
            y = 20;
            count = 0;
        }

        if (count % 4 === 0 && count !== 0) {
            x = 10;
            y += 1.5;
        }
        if (index == 0)
        {
            aspectRatio = image.naturalWidth / image.naturalHeight;
        } 
        const width = 40 
        const height = 40/ aspectRatio;

        

        pdf.addImage(image.src, 'JPEG', x, y, width, height);
        if (count % 2 != 0)
        {
            x += width;
        }
        else
        {
            x += width + 5;
        }
        
        count++;

        if (count % 4 === 0) {
            y += height + 5;
            x = 10;
        }

        
    });

    pdf.save('output2.pdf');
    // Reset imagesUploaded flag
    imagesUploaded = false;
}
</script>
</body>
</html>